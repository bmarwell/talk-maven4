= Maven - was gibt es Neues?
Benjamin Marwell <bmarwell@apache.org>
//:revealjs_autoSlide: 5000
:revealjs_history: true
:revealjs_fragmentInURL: true
:revealjs_viewDistance: 5
:revealjs_width: 1280
:revealjs_height: 720
:revealjs_controls: true
//:revealjs_controlsLayout: edges
:revealjs_controlsTutorial: true
:revealjs_slideNumber: c/t
:revealjs_showSlideNumber: speaker
//:revealjs_autoPlayMedia: true
:revealjs_defaultTiming: 42
:docinfo: shared
// :customcss: css/talk.css
:revealjsdir: reveal.js-3.9.2
// :revealjsdir: reveal.js-4.1.2
:source-highlighter: highlightjs
//:highlightjsdir: highlight.js
:imagesdir: images
:title-slide-background-image: 2022-10-25_mvn_bg.png
:title-slide-transition: zoom
:title-slide-transition-speed: fast
:icons: font


== Über mich

== Inhalt

[%step]
* Maven Wrapper
* Build/Consumer POM
* Improved Reactor
* Maven Daemon

== Umfrage: Wer nutzt Maven?

[%step]
* Wer nutzt Gradle?
* Wer nutzt sbt, Leiningen, ant oder andere Tools?
* Wer nutzt regelmäßig Maven >= 3.8?
* Wer nutzt Maven => 3.6?
* Wer nutzt ein älteres Maven 3?
* Wer nutzt Maven 2?

== Maven Wrapper

=== mvnw: Eine kurze Geschichte

[%step]
* Gestartet von Brian Demers in 2013 als »gradlew«-Klon{empty}footnote:[https://github.com/bdemers/maven-wrapper[]].
* Von 2013 bis 2021 von takari.io gewartet.
* Erstes Release als Apache-Projekt im Dezember 2021{empty}footnote:[https://www.mail-archive.com/users@maven.apache.org/msg143562.html[]].
* Es ist damit ein offizielles Apache-Projekt.

=== Was bietet mvnw?

[%step]
* Jedes Projekt hat alles, was zum Build benötigt wird (bis auf das JDK).
* Läuft auf Linux, MacOS, \*BSD, Solaris, AIX, Windows.
* Lokale Maven-Installationen der Entwickler fallen bei der Fehlersuche nicht mehr ins Gewicht.

[.columns]
=== mvnw: Demo

[.column]
{nbsp}
[.column]
image::terminal-icon.svg[]
[.column]
{nbsp}

{nbsp}

[.notes]
--
* java --version
* mvn --version (nicht installiert)
* ./mvnw validate => läuft
* ls \~/.m2/wrapper/dists/apache-m\*
* git clean -fdX
* ls \~/.mvn/wrapper/
--

== Build/Consumer POM

=== Worum geht es?

Entkoppeln der pom.xml +
aus dem Source-Code-Repository +
von der deployten pom.xml +
im Artefakt-Repository +

=== B/C: Bisheriges Verhalten

image::xml_to_xml.png[{half-width}]


[.notes]
--
* Die pom.xml wird bei der Installation nach \~/.m2 deployed, bei ‚deploy‘/‘release’ ins remote-repo.
* Außer beim Maven-flatten-plugin. Aber zu vernachlässigen.
* Warum ist das so?
* Wir können mit Maven 4 nicht einfach Elemente ändern, hinzufügen oder gar entfernen.
* Tools wie Maven 2 (ja!), SBT, Gradle würden kaputt gehen.
--

=== B/C: künftiges Verhalten

image::xml_to_xml_not_same.png[]

[.notes]
--
* Build/Consumer-POM Dekopplung heißt:
* Das, was auf der Platte ist, ist nicht unbedingt das gleiche wie das, was man hochlädt/installiert.
* Es wird also die Projekt-POM in eine „Consumer-POM“ transformiert. Damit können wir Maven4-Projekte kompatibel machen.
--

=== Build/Consumer-POM: Zusammenfassung

[%steps]
* Entkoppeln der pom.xml aus dem Source-Code-Repository vom deployten pom.xml im Artefakt-Repository.
* Ermöglicht zukünftige Änderungen (Maven 4) an der pom.xml, ohne andere Build-Systeme zu beeinträchtigen. +
… und vor allem: 
* Ohne das komplette Java-Ökosystem zu »zerstören«.

[.notes]
--
* Das ist eines der Grundpfeiler von Maven 4. Dadurch können wir das Schema für die pom.xml in Maven 4 anpassen, ohne das Eco-System kaputt zu machen.
* Würden wir stattdessen die pom.xml GLOBAL anpassen, würden alle neuen pom-Files das Tooling kaputt machen. „Sorry, aber wir wollten Maven erweitern“?
* So macht man sich bestimmt keine Freunde, oder?
--

=== Build/Consumer POM: Demo

[.column]
{nbsp}
[.column]
image::terminal-icon.svg[]
[.column]
{nbsp}

{nbsp}

== Improved Reactor
